{"version":3,"sources":["../sdk/scripts/buildfire/components/control/tagsInput/tagsInput.js"],"names":["buildfire","components","control","Tagify","document","write","tagsInput","constructor","selector","data","this","_readyToFireEvent","_tagifyTags","activeTags","container","_source","settings","source","_sourceType","i","length","_validateSource","Error","sourceType","allowAutoComplete","allowUserInput","languageSettings","placeholder","_init","item","value","_container","querySelector","_buildComponent","_tagify","input","tagifyOptions","whitelist","autoComplete","enabled","rightKey","enforceWhitelist","userInput","on","_onAddRemoveTag","innerHTML","_addButton","addEventListener","set","items","_input","map","tag","onUpdate","tags","append","_tags","Array","isArray","push","addTags","clear","removeAllTags","get","event","userTagsInput","super","options","callback","auth","showTagsSearchDialog","err","result","console","error","_currentTags","allTags","tagName","j","splice"],"mappings":"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","file":"tagsInput.min.js","sourcesContent":["if (typeof buildfire == 'undefined')\r\n\tthrow 'please add buildfire.js first to use buildfire components';\r\nif (typeof buildfire.components == 'undefined') buildfire.components = {};\r\nif (typeof buildfire.components.control == 'undefined') buildfire.components.control = {};\r\n\r\nif (typeof Tagify == 'undefined') {\r\n\tdocument.write('<script src=\"' + '../../../../scripts/tagify/tagify.min.js\"></script>');\r\n\tdocument.write('<script src=\"' + '../../../../scripts/tagify/tagify.polyfills.min.js\"></script>');\r\n}\r\n\r\nbuildfire.components.control.tagsInput = class TagsInput {\r\n\r\n\tconstructor(selector, data = {}) {\r\n\t\t// tags arrays\r\n\t\tthis._readyToFireEvent = true;\r\n\t\tthis._tagifyTags = null;\r\n\t\tthis.activeTags = [];\r\n\t\tthis.container = null;\r\n\t\tthis.selector = selector || null;\r\n\r\n\t\tlet _source = data.settings?.source ? data.settings.source : [];\r\n\t\tlet _sourceType = 'list';\r\n\t\tif (typeof _source === \"function\") {\r\n\t\t\t_sourceType = 'custom';\r\n\t\t} else {\r\n\t\t\t//validate the list\r\n\t\t\tfor (let i = 0; i < _source.length; i++) {\r\n\t\t\t\tif (!this._validateSource(_source[i])) {\r\n\t\t\t\t\tthrow Error('Invalid source, missing value');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.settings = {\r\n\t\t\tsource: _source,\r\n\t\t\tsourceType: _sourceType,\r\n\t\t\tallowAutoComplete: typeof (data.settings?.allowAutoComplete) === 'undefined' ? true : data.settings.allowAutoComplete,\r\n\t\t\tallowUserInput: typeof (data.settings?.allowUserInput) === 'undefined' ? true : data.settings.allowUserInput,\r\n\t\t}\r\n\t\t// languageSettings = strings\r\n\t\tthis.languageSettings = {\r\n\t\t\tplaceholder: data.languageSettings?.placeholder || \"Select Tags\",\r\n\t\t}\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_validateSource(item) {\r\n\t\tif (item && item.value && typeof (item.value) === \"string\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t_init() {\r\n\t\tlet _container = document.querySelector(this.selector);\r\n\t\tif (!_container) throw new Error('Element not found!');\r\n\t\telse {\r\n\t\t\tthis.container = _container;\r\n\t\t\tthis._buildComponent();\r\n\t\t}\r\n\t}\r\n\r\n\t_tagify(input) {\r\n\t\tconst tagifyOptions = {\r\n\t\t\twhitelist: this.settings.sourceType === 'list' ? this.settings.source : [],\r\n\t\t\tautoComplete: {\r\n\t\t\t\tenabled: this.settings.allowAutoComplete,\r\n\t\t\t\trightKey: this.settings.allowAutoComplete\r\n\t\t\t},\r\n\t\t\tenforceWhitelist: false,\r\n\t\t\tuserInput: this.settings.allowUserInput\r\n\t\t}\r\n\r\n\t\tthis._tagifyTags = new Tagify(input, tagifyOptions);\r\n\r\n\t\tthis._tagifyTags.on('remove', () => this._onAddRemoveTag());\r\n\t\tthis._tagifyTags.on('change', () => this._onAddRemoveTag());\r\n\t}\r\n\r\n\t_buildComponent() {\r\n\t\tif (this.settings.sourceType === 'list')\r\n\t\t\tthis.container.innerHTML = `<input type=\"text\" class=\"form-control\" placeholder=\"${this.languageSettings.placeholder}\" >`\r\n\t\telse {\r\n\t\t\tthis.container.innerHTML = `\r\n            <div class=\"input-group\">\r\n                <input type=\"text\" class=\"form-control tagify_input_hide_courser\" placeholder=\"${this.languageSettings.placeholder}\" >\r\n                <span class=\"input-group-addon icon icon-plus add_tagBtn\"></span>\r\n            </div>`\r\n\r\n\t\t\tlet _addButton = this.container.querySelector('span');\r\n\t\t\t_addButton.addEventListener('click', () => {\r\n\t\t\t\tthis.settings.source({}, (items) => {\r\n\t\t\t\t\tthis.set(items);\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tlet _input = this.container.querySelector('input');\r\n\r\n\t\tthis._tagify(_input);\r\n\t}\r\n\r\n\t_onAddRemoveTag() {\r\n\t\tthis.activeTags = (this._tagifyTags.value.length) ? this._tagifyTags.value.map(tag => {\r\n\t\t\treturn tag;\r\n\t\t}) : [];\r\n\r\n\t\tif (this._readyToFireEvent) {\r\n\t\t\tthis.onUpdate({tags: this.activeTags});\r\n\t\t}\r\n\t}\r\n\r\n\t// methods\r\n\tappend(data) {\r\n\t\tlet _tags = [];\r\n\t\tif (data && Array.isArray(data)) {\r\n\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\t\tif (this._validateSource(data[i])) {\r\n\t\t\t\t\t_tags.push(data[i]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow Error('Invalid data, missing value');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this._validateSource(data)) {\r\n\t\t\t\t_tags.push(data);\r\n\t\t\t} else {\r\n\t\t\t\tthrow Error('Invalid data, missing value');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < _tags.length; i++) {\r\n\t\t\tthis.activeTags.push(_tags[i]);\r\n\t\t}\r\n\t\tthis._tagifyTags.addTags(_tags);\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.activeTags = [];\r\n\t\tthis._tagifyTags.removeAllTags();\r\n\t}\r\n\r\n\tset(data) {\r\n\t\tthis._readyToFireEvent = false;\r\n\t\tthis.activeTags = [];\r\n\t\tthis._tagifyTags.removeAllTags();\r\n\t\tthis._readyToFireEvent = true;\r\n\t\tthis.append(data);\r\n\t}\r\n\r\n\tget() {\r\n\t\treturn this.activeTags;\r\n\t}\r\n\r\n\t// events && handlers\r\n\tonUpdate(event) {\r\n\t\tthrow new Error('function not implemented');\r\n\t}\r\n}\r\n\r\nbuildfire.components.control.userTagsInput = class UserTagsInput extends buildfire.components.control.tagsInput {\r\n\r\n\tconstructor(selector, data = {}) {\r\n\r\n\t\tlet _data = {\r\n\t\t\tsettings: {\r\n\t\t\t\tsource: (options, callback) => {\r\n\t\t\t\t\tbuildfire.auth.showTagsSearchDialog(null, (err, result) => {\r\n\t\t\t\t\t\tif (err) return console.error(err);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tlet _currentTags = this.get();\r\n\t\t\t\t\t\t\tlet allTags = [...result, ..._currentTags];\r\n\t\t\t\t\t\t\t// since tagify require value property, we are appending it and we are removing it from exposed method when returning the value \"get, onUpdate\"\r\n\t\t\t\t\t\t\tallTags = allTags.map(tag => ({...tag, value: tag.tagName}));\r\n\r\n\t\t\t\t\t\t\t// remove repeat tags\r\n\t\t\t\t\t\t\tfor (let i = 0; i < allTags.length; i++) {\r\n\t\t\t\t\t\t\t\tfor (let j = i + 1; j < allTags.length; j++) {\r\n\t\t\t\t\t\t\t\t\tif (allTags[i].value === allTags[j].value) {\r\n\t\t\t\t\t\t\t\t\t\tallTags.splice(j, 1);\r\n\t\t\t\t\t\t\t\t\t\tj -= 1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tcallback(allTags);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tallowAutoComplete: false,\r\n\t\t\t\tallowUserInput: false\r\n\t\t\t},\r\n\t\t\tlanguageSettings: data.languageSettings,\r\n\t\t}\r\n\t\tsuper(selector, _data);\r\n\t}\r\n}\r\n"]}